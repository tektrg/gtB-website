---
// src/pages/subscription/success.astro
import Base from '../../layouts/Base.astro';
---

<Base title="Subscription Success - GPT Breeze" description="Your subscription has been successfully processed. Activating your GPT Breeze extension now.">
  <div class="container px-4 py-12 flex flex-col items-center justify-center min-h-[65vh]">
    <div class="max-w-2xl w-full bg-ui-surface rounded-lg border border-ui-border p-8 text-center">
      <!-- Success message -->
      <div class="mb-8">
        <h1 class="text-3xl font-bold mb-4">ðŸŽ‰ Congratulations!</h1>
        <p class="text-lg text-brand-fg mb-2">Your subscription has been successfully processed!</p>
        <p class="text-gray-600">Activating your GPT Breeze extension now...</p>
      </div>
      
      <!-- Loading spinner -->
      <div id="activation-spinner" class="flex flex-col items-center justify-center mb-8">
        <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-brand-accent mb-4"></div>
        <p class="text-gray-600">Please wait while we activate your account...</p>
        <p class="text-gray-600 mt-2">
          Make sure you have installed the
          <a
            href="https://chromewebstore.google.com/detail/gpt-breeze-ai-shortcuts-y/plchckmceefljjjphgfcadhlfnlindog"
            target="_blank"
            rel="noopener noreferrer"
            class="text-brand-accent hover:underline"
          >
            GPT Breeze extension
          </a>
        </p>
      </div>
      
      <!-- Activation success message (hidden by default) -->
      <div id="activation-success" class="">
        <div class="mb-6">
          <h2 class="text-2xl font-bold mb-4">âœ… Extension Activated!</h2>
          <p class="text-brand-fg mb-6">Your GPT Breeze extension is now active and ready to use.</p>
          
          <!-- CTA with YouTube link -->
          <div class="bg-gray-100 p-4 rounded-lg border border-ui-border">
            <p class="text-lg font-medium text-brand-fg mb-3">Ready to try it out?</p>
            <a 
              href="https://www.youtube.com/watch?v=5MuIMqhT8DM&t=1s" 
              target="_blank" 
              rel="noopener noreferrer"
              class="inline-block bg-brand-accent hover:bg-gray-800 text-brand-accent-fg font-medium py-3 px-6 rounded-lg transition duration-200"
              id="try-youtube-link"
            >
              ðŸŽ¬ Try Summarize This YouTube Video
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // Type declaration for global function
    declare global {
      interface Window {
        stopLoadingAndShowActivation?: () => void;
      }
    }

    // Global function that the content script can call
    window.stopLoadingAndShowActivation = function() {
      // Hide the loading spinner
      const spinner = document.getElementById('activation-spinner');
      if (spinner) {
        spinner.classList.add('hidden');
      }
      
      // Show the activation success message
      const successMessage = document.getElementById('activation-success');
      if (successMessage) {
        successMessage.classList.remove('hidden');
      }
      
      // Optional: Add some animation to the success message
      if (successMessage) {
        successMessage.classList.add('animate-fade-in');
      }
    };
  </script>
</Base>